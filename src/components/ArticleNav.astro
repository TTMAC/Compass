---
interface ArticleLink {
  id: string;
  title: string;
  articleNumber: string;
  status: string;
}

interface Props {
  prev: ArticleLink | null;
  next: ArticleLink | null;
}

const { prev, next } = Astro.props;
---

{
  (prev || next) && (
    <nav
      class="mt-12 pt-8 border-t border-gray-200"
      aria-label="Article navigation"
      data-testid="article-nav"
    >
      <div class="flex flex-col sm:flex-row justify-between gap-4">
        {prev ? (
          prev.status === "published" ? (
            <a
              href={`/articles/${prev.id}`}
              class="group flex-1 p-4 border border-gray-200 rounded-lg hover:border-compass-green transition-colors"
              data-article-nav="prev"
              data-target-slug={prev.id}
            >
              <span class="font-heading text-xs text-text-secondary">
                Previous
              </span>
              <p class="font-heading text-sm font-semibold text-text-primary group-hover:text-compass-green transition-colors">
                {prev.articleNumber}: {prev.title}
              </p>
            </a>
          ) : (
            <div class="flex-1 p-4 border border-gray-200 rounded-lg opacity-60">
              <span class="font-heading text-xs text-text-secondary">
                Previous
              </span>
              <p class="font-heading text-sm font-semibold text-text-secondary">
                {prev.articleNumber}: {prev.title}
              </p>
              <span class="font-heading text-[10px] text-text-secondary bg-bg-secondary px-1.5 py-0.5 rounded">
                Coming soon
              </span>
            </div>
          )
        ) : (
          <div class="flex-1" />
        )}

        {next ? (
          next.status === "published" ? (
            <a
              href={`/articles/${next.id}`}
              class="group flex-1 p-4 border border-gray-200 rounded-lg hover:border-compass-green transition-colors text-right"
              data-article-nav="next"
              data-target-slug={next.id}
            >
              <span class="font-heading text-xs text-text-secondary">Next</span>
              <p class="font-heading text-sm font-semibold text-text-primary group-hover:text-compass-green transition-colors">
                {next.articleNumber}: {next.title}
              </p>
            </a>
          ) : (
            <div class="flex-1 p-4 border border-gray-200 rounded-lg opacity-60 text-right">
              <span class="font-heading text-xs text-text-secondary">Next</span>
              <p class="font-heading text-sm font-semibold text-text-secondary">
                {next.articleNumber}: {next.title}
              </p>
              <span class="font-heading text-[10px] text-text-secondary bg-bg-secondary px-1.5 py-0.5 rounded">
                Coming soon
              </span>
            </div>
          )
        ) : (
          <div class="flex-1" />
        )}
      </div>
    </nav>
  )
}

<script>
  document.querySelectorAll("[data-article-nav]").forEach((link) => {
    link.addEventListener("click", () => {
      if (typeof (window as any).gtag === "function") {
        const direction = link.getAttribute("data-article-nav");
        const targetSlug = link.getAttribute("data-target-slug");
        const currentSlug = window.location.pathname.replace(/^\/articles\//, "").replace(/\/$/, "");
        (window as any).gtag("event", "article_navigate", {
          from: currentSlug,
          to: targetSlug,
          direction: direction,
        });
      }
    });
  });
</script>
